name: Crawl
on:
  workflow_dispatch:
  push:
    branches: [ "main" ]
jobs:
  us:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit US to Google/Bing/IndexNow
        shell: bash
        run: |
          for ENGINE in Google Bing IndexNow; do
            if [ "$ENGINE" = "Google" ]; then
              curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/us/sitemap.xml"
            elif [ "$ENGINE" = "Bing" ]; then
              curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/us/sitemap.xml"
            else
              curl -H 'Content-Type: application/json' \
                   -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/us/sitemap.xml"]}' \
                   "https://api.indexnow.org/indexnow"
            fi
          done
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-us
          path: crawl_log_us.txt

  uk:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit UK to Google/Bing/IndexNow
        shell: bash
        run: |
          curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/uk/sitemap.xml"
          curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/uk/sitemap.xml"
          curl -H 'Content-Type: application/json' \
               -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/uk/sitemap.xml"]}' \
               "https://api.indexnow.org/indexnow"
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-uk
          path: crawl_log_uk.txt

  ca:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit CA to Google/Bing/IndexNow
        shell: bash
        run: |
          curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/ca/sitemap.xml"
          curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/ca/sitemap.xml"
          curl -H 'Content-Type: application/json' \
               -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/ca/sitemap.xml"]}' \
               "https://api.indexnow.org/indexnow"
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-ca
          path: crawl_log_ca.txt

  au:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit AU to Google/Bing/IndexNow
        shell: bash
        run: |
          curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/au/sitemap.xml"
          curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/au/sitemap.xml"
          curl -H 'Content-Type: application/json' \
               -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/au/sitemap.xml"]}' \
               "https://api.indexnow.org/indexnow"
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-au
          path: crawl_log_au.txt

  de:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit DE to Google/Bing/IndexNow
        shell: bash
        run: |
          curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/de/sitemap.xml"
          curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/de/sitemap.xml"
          curl -H 'Content-Type: application/json' \
               -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/de/sitemap.xml"]}' \
               "https://api.indexnow.org/indexnow"
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-de
          path: crawl_log_de.txt

  ch:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit CH to Google/Bing/IndexNow
        shell: bash
        run: |
          curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/ch/sitemap.xml"
          curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/ch/sitemap.xml"
          curl -H 'Content-Type: application/json' \
               -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/ch/sitemap.xml"]}' \
               "https://api.indexnow.org/indexnow"
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-ch
          path: crawl_log_ch.txt

  sg:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Submit SG to Google/Bing/IndexNow
        shell: bash
        run: |
          curl -X POST "https://www.google.com/ping?sitemap=https://newspreadnow.com/sg/sitemap.xml"
          curl -X GET "https://www.bing.com/ping?sitemap=https://newspreadnow.com/sg/sitemap.xml"
          curl -H 'Content-Type: application/json' \
               -d '{"host":"newspreadnow.com","urlList":["https://newspreadnow.com/sg/sitemap.xml"]}' \
               "https://api.indexnow.org/indexnow"
      - uses: actions/upload-artifact@v4
        with:
          name: crawl-logs-sg
          path: crawl_log_sg.txt
